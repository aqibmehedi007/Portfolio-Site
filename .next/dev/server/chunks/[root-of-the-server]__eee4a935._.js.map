{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/GitHub/Portfolio-Site/src/core/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n    prisma: PrismaClient | undefined;\r\n};\r\n\r\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient();\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,sMAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///D:/GitHub/Portfolio-Site/src/app/api/track/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { prisma } from \"@/core/prisma\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n    try {\r\n        const { platform, language } = await req.json();\r\n\r\n        // Get IP from headers (CPanel/Proxies)\r\n        const ip = req.headers.get(\"x-forwarded-for\")?.split(\",\")[0] ||\r\n            req.headers.get(\"x-real-ip\") ||\r\n            \"Unknown\";\r\n\r\n        const userAgent = req.headers.get(\"user-agent\") || \"Unknown\";\r\n\r\n        // Optional: Simple UA Parsing\r\n        let device = \"Desktop\";\r\n        if (/mobile/i.test(userAgent)) device = \"Mobile\";\r\n        else if (/tablet/i.test(userAgent)) device = \"Tablet\";\r\n\r\n        let browser = \"Other\";\r\n        if (/chrome/i.test(userAgent)) browser = \"Chrome\";\r\n        else if (/firefox/i.test(userAgent)) browser = \"Firefox\";\r\n        else if (/safari/i.test(userAgent) && !/chrome/i.test(userAgent)) browser = \"Safari\";\r\n        else if (/edge/i.test(userAgent)) browser = \"Edge\";\r\n\r\n        // Try to get Geo location from IP via a free API (ip-api.com)\r\n        let geoData = { city: null, country: null, lat: null, lon: null };\r\n        try {\r\n            if (ip !== \"Unknown\" && ip !== \"127.0.0.1\" && ip !== \"::1\") {\r\n                const geoRes = await fetch(`http://ip-api.com/json/${ip}`);\r\n                const data = await geoRes.json();\r\n                if (data.status === \"success\") {\r\n                    geoData = {\r\n                        city: data.city,\r\n                        country: data.country,\r\n                        lat: data.lat,\r\n                        lon: data.lon\r\n                    };\r\n                }\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Geo lookup failed:\", e);\r\n        }\r\n\r\n        // Save or update visitor record\r\n        await prisma.visitor.upsert({\r\n            where: { ip: ip },\r\n            update: {\r\n                lastVisit: new Date(),\r\n                visitCount: { increment: 1 },\r\n                userAgent,\r\n                device,\r\n                browser,\r\n                city: geoData.city,\r\n                country: geoData.country,\r\n                latitude: geoData.lat,\r\n                longitude: geoData.lon\r\n            },\r\n            create: {\r\n                ip,\r\n                userAgent,\r\n                device,\r\n                browser,\r\n                city: geoData.city,\r\n                country: geoData.country,\r\n                latitude: geoData.lat,\r\n                longitude: geoData.lon\r\n            }\r\n        });\r\n\r\n        return NextResponse.json({ success: true });\r\n    } catch (error) {\r\n        console.error(\"Visitor tracking error:\", error);\r\n        return NextResponse.json({ success: false }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAgB;IACvC,IAAI;QACA,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;QAE7C,uCAAuC;QACvC,MAAM,KAAK,IAAI,OAAO,CAAC,GAAG,CAAC,oBAAoB,MAAM,IAAI,CAAC,EAAE,IACxD,IAAI,OAAO,CAAC,GAAG,CAAC,gBAChB;QAEJ,MAAM,YAAY,IAAI,OAAO,CAAC,GAAG,CAAC,iBAAiB;QAEnD,8BAA8B;QAC9B,IAAI,SAAS;QACb,IAAI,UAAU,IAAI,CAAC,YAAY,SAAS;aACnC,IAAI,UAAU,IAAI,CAAC,YAAY,SAAS;QAE7C,IAAI,UAAU;QACd,IAAI,UAAU,IAAI,CAAC,YAAY,UAAU;aACpC,IAAI,WAAW,IAAI,CAAC,YAAY,UAAU;aAC1C,IAAI,UAAU,IAAI,CAAC,cAAc,CAAC,UAAU,IAAI,CAAC,YAAY,UAAU;aACvE,IAAI,QAAQ,IAAI,CAAC,YAAY,UAAU;QAE5C,8DAA8D;QAC9D,IAAI,UAAU;YAAE,MAAM;YAAM,SAAS;YAAM,KAAK;YAAM,KAAK;QAAK;QAChE,IAAI;YACA,IAAI,OAAO,aAAa,OAAO,eAAe,OAAO,OAAO;gBACxD,MAAM,SAAS,MAAM,MAAM,CAAC,uBAAuB,EAAE,IAAI;gBACzD,MAAM,OAAO,MAAM,OAAO,IAAI;gBAC9B,IAAI,KAAK,MAAM,KAAK,WAAW;oBAC3B,UAAU;wBACN,MAAM,KAAK,IAAI;wBACf,SAAS,KAAK,OAAO;wBACrB,KAAK,KAAK,GAAG;wBACb,KAAK,KAAK,GAAG;oBACjB;gBACJ;YACJ;QACJ,EAAE,OAAO,GAAG;YACR,QAAQ,KAAK,CAAC,sBAAsB;QACxC;QAEA,gCAAgC;QAChC,MAAM,iIAAM,CAAC,OAAO,CAAC,MAAM,CAAC;YACxB,OAAO;gBAAE,IAAI;YAAG;YAChB,QAAQ;gBACJ,WAAW,IAAI;gBACf,YAAY;oBAAE,WAAW;gBAAE;gBAC3B;gBACA;gBACA;gBACA,MAAM,QAAQ,IAAI;gBAClB,SAAS,QAAQ,OAAO;gBACxB,UAAU,QAAQ,GAAG;gBACrB,WAAW,QAAQ,GAAG;YAC1B;YACA,QAAQ;gBACJ;gBACA;gBACA;gBACA;gBACA,MAAM,QAAQ,IAAI;gBAClB,SAAS,QAAQ,OAAO;gBACxB,UAAU,QAAQ,GAAG;gBACrB,WAAW,QAAQ,GAAG;YAC1B;QACJ;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC7C,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAM,GAAG;YAAE,QAAQ;QAAI;IAC/D;AACJ"}}]
}